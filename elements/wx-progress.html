<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="wx-progress" noscript>
    <template>
        <style>
            :host {
                display: block;
                height: 1em;
            }
            @-webkit-keyframes animate-stripes {
                100% { background-position: -100px 0px; }
            }
            @keyframes animate-stripes {
                100% { background-position: -100px 0px; }
            }

            .progress-wrap{text-align: center;height: 100%;}
            .progress-bar {
                border-radius: 2px;
                background-color: whiteSmoke;
                box-shadow: 0 2px 3px rgba(0, 0, 0, 0.25) inset;
                width: 100%;
                height: 100%;

                position: relative;
                display: inline-block;
            }

            .progress-bar span {
                border-radius: 2px;
                height: 100%;
                display: block;
                text-indent: -9999px;
            }

            .striper{
                border-radius: 2px;
                background-color: #BBB;
                background-image:-webkit-linear-gradient(-45deg,transparent 33%, rgba(0, 0, 0, .1) 33%,rgba(0,0, 0, .1) 66%, transparent 66%),-webkit-linear-gradient(top,rgba(255, 255, 255, .25),rgba(0, 0, 0, .25)),-webkit-linear-gradient(left, #FCFEFC, #FCFEFC);
                background-image:-moz-linear-gradient(-45deg,transparent 33%, rgba(0, 0, 0, .1) 33%,rgba(0,0, 0, .1) 66%, transparent 66%),-moz-linear-gradient(to bottom,rgba(255, 255, 255, .25),rgba(0, 0, 0, .25)),-moz-linear-gradient(to right, #FCFEFC, #FCFEFC);
                background-image:linear-gradient(-45deg,transparent 33%, rgba(0, 0, 0, .1) 33%,rgba(0,0, 0, .1) 66%, transparent 66%),linear-gradient(to bottom,rgba(255, 255, 255, .25),rgba(0, 0, 0, .25)),linear-gradient(to right, #FCFEFC, #FCFEFC);
                background-size: 2.5em 100%, 100% 100%, 100% 100%;
                -webkit-animation: animate-stripes 5s linear infinite;
                animation: animate-stripes 5s linear infinite;
            }

        </style>

        <div class="progress-wrap">
            <div class="progress-bar">
                <span class="striper" style="width: {{percent}}"> </span>
            </div>
        </div>

    </template>


    <script>

        ;(function(){

            var getPercent = function(val,total){
                var res = null;
                if(total>0){
                    var iPlus = val + 0;
                    if(iPlus>=total){
                        res = "100%";
                    }else{
                        res = ((iPlus / total) * 100)+"%";
                    }
                }else{
                    return 0;
                }
                return res;
            };

            var setProg = function(){
                this.percent = getPercent(this.value,this.max);
            };

            //"'this' point to element itself
            var conf = {
                setProg:setProg,
                publish: {
                    value:0,
                    max:10
                },
                ready: function() {
                    // initialize the element's model
                    this.setProg();
                },
                valueChanged: function(oldValue, newValue) {
                    this.setProg();
                },
                maxChanged: function(oldValue, newValue) {
                    this.setProg();
                },
                attributeChanged: function(attrName, oldVal, newVal) {
                    //var newVal = this.getAttribute(attrName);
                    this.setProg();
                }
            };

            Polymer('wx-progress', conf);

        })();
    </script>


</polymer-element>